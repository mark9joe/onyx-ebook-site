name: Build RSS + Sitemap

on: push: branches: - main schedule: - cron: '0 */3 * * *'  # Every 3 hours

jobs: generate: runs-on: ubuntu-latest

steps:
  - name: ğŸ“† Checkout repo
    uses: actions/checkout@v3

  - name: ğŸ¦ Set up Python
    uses: actions/setup-python@v4
    with:
      python-version: 3.11

  - name: âš¡ Install requests lib
    run: pip install requests

  - name: ğŸ“ˆ Generate RSS Feed
    run: python scripts/build_rss.py

  - name: ğŸ—º Generate Sitemap
    run: python scripts/build_sitemap.py

  - name: â˜ï¸ Ping Google & Bing
    run: |
      curl https://www.google.com/ping?sitemap=https://respirework.com/sitemap.xml
      curl https://www.bing.com/ping?sitemap=https://respirework.com/sitemap.xml

  - name: âœ… Commit & Push updates
    run: |
      git config --global user.email "rssbot@respirework.com"
      git config --global user.name "RSSBot"
      git add .
      git commit -m "ğŸ“° Auto-generate RSS + Sitemap"
      git push
    env:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
